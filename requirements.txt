# ============================================================================
# PRODUCTION DEPENDENCIES - Local RAG Pipeline
# ============================================================================
# Core dependencies for running the RAG pipeline in production.
# All versions are pinned with == for reproducibility.
# Install with: pip install -r requirements.txt
#
# For optional features: pip install -r requirements-optional.txt
# For development: pip install -r requirements-dev.txt
# For vLLM GPU backend: pip install -r config/requirements_vllm.txt
#
# Feature Flags:
#   - Reranking: requires sentence-transformers
#   - Semantic caching: requires scikit-learn
#   - Query expansion: requires nltk
#   - Metadata extraction: requires nltk, scikit-learn
#   - MLX embeddings (M1 Mac): requires mlx (install from requirements-optional.txt)
#
# Last updated: 2026-01-07
# Python: 3.11+
# ============================================================================

# ----------------------------------------------------------------------------
# Core LlamaIndex Framework
# ----------------------------------------------------------------------------
llama-index==0.14.10
llama-index-core==0.14.10
llama-index-embeddings-huggingface==0.6.1
llama-index-embeddings-openai==0.5.1
llama-index-indices-managed-llama-cloud==0.9.4
llama-index-instrumentation==0.4.2
llama-index-llms-llama-cpp==0.5.1
llama-index-llms-openai==0.6.12
llama-index-readers-file==0.5.5
llama-index-readers-llama-parse==0.5.1
llama-index-vector-stores-postgres==0.7.2
llama-index-workflows==2.11.5

# ----------------------------------------------------------------------------
# LLM Backends (Local Inference)
# ----------------------------------------------------------------------------
llama_cpp_python==0.3.16          # Local LLM inference (llama.cpp)

# ----------------------------------------------------------------------------
# Cloud GPU Management
# ----------------------------------------------------------------------------
runpod>=1.7.5                     # RunPod API for GPU pod management

# ----------------------------------------------------------------------------
# API Service (FastAPI for RunPod Embedding Service)
# ----------------------------------------------------------------------------
fastapi>=0.115.0                  # Modern web framework for embedding API
uvicorn[standard]>=0.34.0         # ASGI server with performance optimizations
pydantic>=2.10.0                  # Data validation (included with FastAPI)

# ----------------------------------------------------------------------------
# Embeddings & Machine Learning
# (Used for embeddings, reranking, semantic cache, query expansion, metadata)
# ----------------------------------------------------------------------------
sentence-transformers==5.2.0      # Semantic embeddings (core); also used by reranker
torch==2.9.1                      # PyTorch (required for embeddings)
transformers==4.57.3              # HuggingFace transformers
tokenizers==0.22.1                # Fast tokenizers
safetensors==0.7.0                # Safe tensor storage
huggingface-hub==0.36.0           # Model hub client
scikit-learn==1.8.0               # ML utilities (cosine similarity for reranking, semantic cache)
scipy==1.16.3                     # Scientific computing
numpy==2.3.5                      # Numerical operations

# ----------------------------------------------------------------------------
# Vector Database & Storage
# ----------------------------------------------------------------------------
psycopg2-binary==2.9.11           # PostgreSQL adapter
pgvector==0.4.2                   # Vector similarity extension
SQLAlchemy==2.0.45                # SQL toolkit
asyncpg==0.31.0                   # Async PostgreSQL

# ----------------------------------------------------------------------------
# Document Processing
# ----------------------------------------------------------------------------
PyMuPDF==1.26.7                   # PDF processing
pypdf==6.6.0                      # Alternative PDF parser (upgraded for CVE fixes)
python-docx==1.2.0                # Word document support
beautifulsoup4==4.14.3            # HTML parsing
lxml==6.0.2                       # XML/HTML parser
striprtf==0.0.26                  # RTF file support
defusedxml==0.7.1                 # Secure XML parsing

# ----------------------------------------------------------------------------
# Data Processing & Utilities
# (nltk used for query expansion, metadata extraction, semantic caching)
# ----------------------------------------------------------------------------
pandas==2.2.3                     # Data manipulation
python-dateutil==2.9.0.post0      # Date/time utilities
pytz==2025.2                      # Timezone support
tzdata==2025.3                    # Timezone data
regex==2025.11.3                  # Advanced regex
nltk==3.9.2                       # Natural language processing (query expansion, metadata)
joblib==1.5.3                     # Parallel processing utilities
threadpoolctl==3.6.0              # Thread pool control

# ----------------------------------------------------------------------------
# API Clients & Networking
# ----------------------------------------------------------------------------
openai==2.13.0                    # OpenAI API client
requests==2.32.5                  # HTTP library
httpx==0.28.1                     # Modern HTTP client
httpcore==1.0.9                   # HTTP core
aiohttp==3.13.3                   # Async HTTP
aiohappyeyeballs==2.6.1           # Fast async DNS
aiosignal==1.4.0                  # Async signals
aiosqlite==0.22.0                 # Async SQLite
certifi==2025.11.12               # SSL certificates
urllib3==2.6.3                    # HTTP client
idna==3.11                        # IDNA encoding

# ----------------------------------------------------------------------------
# Configuration & Environment
# ----------------------------------------------------------------------------
python-dotenv==1.2.1              # .env file support
PyYAML==6.0.3                     # YAML parsing
click==8.3.1                      # CLI framework
colorama==0.4.6                   # Terminal colors

# ----------------------------------------------------------------------------
# Web UI & Authentication
# ----------------------------------------------------------------------------
streamlit>=1.31.0                 # Web UI framework
plotly>=5.18.0                    # Interactive visualizations for web UI
streamlit-authenticator>=0.3.3    # Complete authentication module with cookie/session management
argon2-cffi>=23.1.0               # Argon2id password hashing (2026 standard, GPU-resistant)

# ----------------------------------------------------------------------------
# Validation & Serialization
# ----------------------------------------------------------------------------
pydantic==2.12.5                  # Data validation
pydantic_core==2.41.5             # Pydantic core
marshmallow==3.26.2               # Serialization
dataclasses-json==0.6.7           # Dataclass JSON support
dirtyjson==1.0.8                  # Lenient JSON parser

# ----------------------------------------------------------------------------
# Caching & Storage
# ----------------------------------------------------------------------------
diskcache==5.6.3                  # Disk-based cache
filelock==3.20.3                  # File locking

# ----------------------------------------------------------------------------
# Monitoring & Utilities
# ----------------------------------------------------------------------------
psutil==7.1.3                     # System monitoring
tqdm==4.67.1                      # Progress bars
tenacity==9.1.2                   # Retry logic

# ----------------------------------------------------------------------------
# Type Checking & Extensions
# ----------------------------------------------------------------------------
typing_extensions==4.15.0         # Typing backports
typing-inspect==0.9.0             # Type inspection
typing-inspection==0.4.2          # Type inspection utilities
mypy_extensions==1.1.0            # MyPy extensions

# ----------------------------------------------------------------------------
# Supporting Libraries
# ----------------------------------------------------------------------------
annotated-types==0.7.0            # Type annotations
anyio==4.12.0                     # Async compatibility
attrs==25.4.0                     # Classes without boilerplate
Deprecated==1.2.18                # Deprecation warnings
distro==1.9.0                     # OS detection
frozenlist==1.8.0                 # Frozen lists
fsspec==2025.12.0                 # Filesystem spec
greenlet==3.3.0                   # Lightweight threads
griffe==1.15.0                    # Python signatures
h11==0.16.0                       # HTTP/1.1 protocol
Jinja2==3.1.6                     # Templating
jiter==0.12.0                     # Fast JSON iterator
MarkupSafe==3.0.3                 # Safe string markup
mpmath==1.3.0                     # Multiprecision math
multidict==6.7.0                  # Multi-value dicts
nest-asyncio==1.6.0               # Nested async support
networkx==3.6.1                   # Network analysis
packaging==25.0                   # Package version parsing
pillow==12.0.0                    # Image processing
platformdirs==4.5.1               # Platform directories
propcache==0.4.1                  # Property caching
six==1.17.0                       # Python 2/3 compatibility
sniffio==1.3.1                    # Async library detection
soupsieve==2.8                    # CSS selector library
sympy==1.14.0                     # Symbolic mathematics
tiktoken==0.12.0                  # OpenAI tokenizer
wrapt==1.17.3                     # Object proxying
yarl==1.22.0                      # URL parsing

# ----------------------------------------------------------------------------
# LlamaIndex Cloud (Optional but included in main install)
# ----------------------------------------------------------------------------
llama-cloud==0.1.35
llama-cloud-services==0.6.54
llama-parse==0.6.54
llama-index-cli==0.5.3

# ----------------------------------------------------------------------------
# Specialized Libraries
# ----------------------------------------------------------------------------
banks==2.2.0                      # Banking data
charset-normalizer==3.4.4         # Character encoding detection
filetype==1.2.0                   # File type detection
hf-xet==1.2.0                     # HuggingFace XET

# ----------------------------------------------------------------------------
# Monitoring & Observability
# ----------------------------------------------------------------------------
prometheus-client==0.23.1         # Prometheus metrics export
